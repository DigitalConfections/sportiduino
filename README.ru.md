![](https://raw.githubusercontent.com/alexandervolikov/sportiduino/master/Images/logo.png)

#### Version 1.1.0

![](https://raw.githubusercontent.com/alexandervolikov/sportIDuino/master/Images/Sportiduino.JPG)

[Read this in English](https://github.com/alexandervolikov/sportiduino/blob/master/README.md)

Данный репозиторий посвящен аппаратной части системы отметки.

На данный момент активная разработка завершена, силы перенесены на разработку программного обеспечения для работы с системой.

Просьба создавать issue, если найдете баг или если у Вас появяться вопросы или предложения касаемые аппаратной части системы. По иным вопросам просьба писать на почту (есть в информации профиля).
Буду рад активной помощи в виде pull request. Также поддерживаю создание Форков.

Программное обеспечение находится в стадии разработки, ссылки будут помещаться ниже в разделе "Обработка данных".

Также постепенно будет добавляться и обновляться информация, помещенная в wiki проекта. 

Проект свободный. В данный момент изготовление на продажу не осуществляется. Но, кто не боится трудностей, может попоробовать сделать это самостоятельно следуя инструкциям из wiki. Дешевизна компонентов системы может окупить затраченные труды (порядка 500 рублей за базовую станцию, 20 рублей за чип отметки).

Предупреждаю, что разработка носит характер хобби, автор не является профессионалом в области электроники и программирования. Поэтому никаких гарантий не даётся, возможны разного рода проблеммы при воспроизведении. Поддержка также не обещается. Так что, действуйте на свой риск. 

****

[Общее руководство в Wiki](https://github.com/alexandervolikov/sportiduino/wiki/%D0%A1%D0%B8%D1%81%D1%82%D0%B5%D0%BC%D0%B0-%D0%BE%D1%82%D0%BC%D0%B5%D1%82%D0%BA%D0%B8-Sportiduino)

## Чипы

В системе используются чипы Ntag213 / 215 / 216. В виде наклеек данные чипы стоят 6, 12 и 20 рублей, соответветственно, в виде брелка в два раза дороже. Памяти данных чипов хватает на 32, 120 и 216 отметок, соответственно.

[Подробнее тут](https://github.com/alexandervolikov/sportIDuino/wiki/%D0%A7%D0%B8%D0%BF%D1%8B)

## Станции отметки.

Основные компоненты станции - микроконтроллер Atmega328 и модуль MFRC522, работающий на частоте 13,56MHz. Питание от 3-х пальчиковых батареек через стабилизатор MCP1700T-33

Реализовано 3 режима работы станции:

* Режим сна (хранения). Опрос чипа раз в 25 секунд. При нахождении чипа происходит перезагрузка со вхождением в режим ожидания. При этом происходит сигнализицая состояния системы - наличие ошибок и состояние батареи, очистка лога станций. 

* Рабочий режим. Опрос чипа раз в 250 мс. По умолчанию, при бездействии более 6 часов переходит в режим ожидания. Возможна настройка времени перехода. 

* Режим ожидания. Опрос чипа раз в секунду. При нахождении чипа переходит в рабочий режим. 

Емкости комплекта из трех щелочных батарей АА (4.5 В, 2000mAh), ориентировочно, хватит на 5 лет в режиме сна, 160 дней в режиме ожидания или 40 дней в рабочем режиме. Одного комплекта должно хватать на год активного использования.
Станции также могут работат и при отрицательных температурах (протестирована работа до -20С), но нужно учитывать сокращение срока работы в виду падения емкости батарей на холоде.

В станции установлены часы DS3231. Время корректируется с помощью специального чипа, который записывается станцией сопряжения.

Надежность работы станции от зависания обеспечивает watchdog, который перезапускает станцию в случае сбоев. Успешность записи отметки на чип контролируется последующим считыванием,только после этого станция подаёт сигнал отметки. Также в станциях реализована запись номеров отметившихся чипов. Реализована система паролей для избежания вандализма.

Корпус - доступный Gainta g1020bf с фланцами. Герметизация осуществляется за счёт использование герметика.

Суммарно исходные компоненты станции и расходники стоят порядка 500 рублей. Инструкция по изготвления находится в вики.

[Подробнее тут](https://github.com/alexandervolikov/sportIDuino/wiki/%D0%A1%D1%82%D0%B0%D0%BD%D1%86%D0%B8%D0%B8-%D0%BE%D1%82%D0%BC%D0%B5%D1%82%D0%BA%D0%B8)

## Станция сопряжения

Станция сопряжения попроще станции отметки, состоит из Arduino Nano, RFID-модуля, светодиода и пищалки.
К компьютеру подключение через USB. С помощью станции сопряжения можно выполнять ряд судейских задач:

1. Настройка системы перед стартом: установка времени на станциях, установка номеров на станциях, а также настройка станции - установка пароля на мастер-ключи, времени рабочего режима.
2. Перед и во время старта: очистка и выдача чипов участникам
3. После старта: считывание чипов, создание таблицы сплитов
4. После финиша: считывание лога со станций отметок.

[Подробнее тут](https://github.com/alexandervolikov/sportIDuino/wiki/%D0%A1%D1%82%D0%B0%D0%BD%D1%86%D0%B8%D1%8F-%D1%81%D0%BE%D0%BF%D1%80%D1%8F%D0%B6%D0%B5%D0%BD%D0%B8%D1%8F)

Также есть беспроводная станция сопряжени с модулем bluetooth. Ведётся разарботка программного обеспечения под Android.

## Обработка данных

Разработка программного обеспечения в IDE Processing вынесена в отдельний репозиторий:
https://github.com/alexandervolikov/sportiduinoProcessing
Функционал минимальный.

Ведётся разработка модуля на python для программы [SportOrg ](https://github.com/sportorg/pysport)
Репозиторий модуля также отдельный:
https://github.com/alexandervolikov/sportiduinoPython

***********
Версия 0.28, публикация на geektimes:
https://geektimes.ru/post/290057/
Версия 0.41, публикация на geektimes:
https://geektimes.ru/post/294277/

***********
Available from:  https://github.com/alexandervolikov/sportiduino
 
License:         GNU GPLv3